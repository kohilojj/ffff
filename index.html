<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <title>Jassu & Jepu: Koominen Kasvotsunami</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; background: #87CEEB; font-family: 'Comic Sans MS', cursive; }
        #ui { position: absolute; top: 10px; left: 10px; pointer-events: none; z-index: 10; }
        #score { font-size: 30px; color: white; text-shadow: 2px 2px 0 #000; }
        .instrukti { position: absolute; bottom: 10px; width: 100%; text-align: center; color: white; z-index: 10; }
        canvas { display: block; }
    </style>
</head>
<body>

<div id="ui">
    <div id="score">Pisteet: 0</div>
</div>
<div class="instrukti">Klikkaa naamoja! (Jos kuvat ei lataa, näet väripalloja)</div>

<script>
    const { Engine, Render, Runner, Bodies, Composite, Mouse, MouseConstraint, Events } = Matter;

    const engine = Engine.create();
    const render = Render.create({
        element: document.body,
        engine: engine,
        options: {
            width: window.innerWidth,
            height: window.innerHeight,
            wireframes: false, // TÄRKEÄ: Pitää olla false
            background: '#87CEEB'
        }
    });

    // Seinät
    const ground = Bodies.rectangle(window.innerWidth/2, window.innerHeight + 30, window.innerWidth, 60, { isStatic: true });
    const leftWall = Bodies.rectangle(-30, window.innerHeight/2, 60, window.innerHeight, { isStatic: true });
    const rightWall = Bodies.rectangle(window.innerWidth + 30, window.innerHeight/2, 60, window.innerHeight, { isStatic: true });
    Composite.add(engine.world, [ground, leftWall, rightWall]);

    let score = 0;

    function spawnFace() {
        const x = Math.random() * window.innerWidth;
        const isJassu = Math.random() > 0.5;
        const imgPath = isJassu ? 'jassu.png' : 'jepu.png';

        const face = Bodies.circle(x, -50, 45, {
            restitution: 0.6,
            friction: 0.1,
            render: {
                // Jos kuva löytyy, se käytetään. Jos ei, näkyy väri.
                fillStyle: isJassu ? '#FFD700' : '#FF69B4', 
                sprite: {
                    texture: imgPath,
                    xScale: 0.5,
                    yScale: 0.5
                }
            }
        });

        face.label = "clickable";
        Composite.add(engine.world, face);
    }

    // Hiirikontrolli
    const mouse = Mouse.create(render.canvas);
    const mouseConstraint = MouseConstraint.create(engine, {
        mouse: mouse,
        constraint: { stiffness: 0.2, render: { visible: false } }
    });
    Composite.add(engine.world, mouseConstraint);

    // Klikkauksen tunnistus
    Events.on(mouseConstraint, "mousedown", function(event) {
        const mousePosition = event.mouse.position;
        const bodies = Composite.allBodies(engine.world);
        
        bodies.forEach(body => {
            if (body.label === "clickable" && Matter.Bounds.contains(body.bounds, mousePosition)) {
                Composite.remove(engine.world, body);
                score += 10;
                document.getElementById('score').innerText = "Pisteet: " + score;
            }
        });
    });

    // Käynnistys
    Render.run(render);
    const runner = Runner.create();
    Runner.run(runner, engine);

    // Tiputustiheys (800ms = nopeampi)
    setInterval(spawnFace, 800);

    // Korjaus ikkunan koon muutokseen
    window.addEventListener('resize', () => {
        render.canvas.width = window.innerWidth;
        render.canvas.height = window.innerHeight;
    });
</script>
</body>
</html>
