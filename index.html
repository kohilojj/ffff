<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tinder-Akatemia: Treffi-Mestari</title>
    <style>
        :root { --tinder-pink: #fe3c72; --gold: #ffd700; --bg: #f0f2f5; }
        body { margin: 0; background: var(--bg); font-family: -apple-system, sans-serif; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        /* Mittarit */
        #stat-bar { background: white; padding: 15px; display: flex; justify-content: space-around; border-bottom: 2px solid #ddd; font-weight: bold; font-size: 14px; }
        #charm-bar-container { width: 100%; height: 10px; background: #ddd; }
        #charm-fill { height: 100%; background: var(--tinder-pink); width: 0%; transition: 0.5s; }

        #chat-history { flex-grow: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px; background: white; }
        .msg { padding: 12px 16px; border-radius: 20px; max-width: 75%; font-size: 15px; }
        .msg.me { align-self: flex-end; background: var(--tinder-pink); color: white; }
        .msg.them { align-self: flex-start; background: #e9e9eb; color: black; }

        #options-container { height: 300px; overflow-y: auto; background: #fff; padding: 10px; border-top: 1px solid #ddd; display: grid; gap: 8px; }
        .option { padding: 12px; border-radius: 12px; border: 1px solid #ddd; background: #f8f9fa; font-size: 14px; cursor: pointer; }
        .option:hover { border-color: var(--tinder-pink); background: #fff5f7; }

        /* Palaute-ikkuna */
        #coach-feedback {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); display: none; flex-direction: column;
            align-items: center; justify-content: center; z-index: 2000; color: white; padding: 20px;
        }
        .feedback-card { background: white; color: black; padding: 25px; border-radius: 25px; max-width: 320px; text-align: center; }
        .feedback-card img { width: 100px; height: 100px; border-radius: 50%; border: 4px solid var(--tinder-pink); margin-bottom: 15px; }
        
        #victory-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--gold); display: none; flex-direction: column;
            align-items: center; justify-content: center; z-index: 3000; text-align: center;
        }
    </style>
</head>
<body>

<div id="stat-bar">
    <span>üíé Taso: <span id="rank">Aloittelija</span></span>
    <span>üèÜ Charm: <span id="charm-val">0</span>/200</span>
</div>
<div id="charm-bar-container"><div id="charm-fill"></div></div>

<div id="chat-history">
    <div class="msg them">Moi! Sulla oli tosi mielenkiintoinen profiili. Mit√§s s√§ tykk√§√§t tehd√§ vapaa-ajalla? üòä</div>
</div>

<div id="options-container"></div>

<div id="coach-feedback">
    <div class="feedback-card">
        <img id="coach-img" src="jassu.png">
        <h3 id="coach-title">Jassun Vinkki</h3>
        <p id="coach-txt"></p>
        <button onclick="closeFeedback()" style="background:var(--tinder-pink); color:white; border:none; padding:12px 25px; border-radius:15px; font-weight:bold; cursor:pointer;">Yrit√§n uudestaan!</button>
    </div>
</div>

<div id="victory-screen">
    <h1 style="font-size: 50px;">TREFFIT sovittu! ü•Ç</h1>
    <p style="font-size: 20px; font-weight: bold;">Sait tytt√∂yst√§v√§n (peliss√§)!</p>
    <div style="display:flex; gap:10px; margin:20px;">
        <img src="jassu.png" width="70">
        <img src="jepu.png" width="70">
    </div>
    <button onclick="location.reload()" style="padding:15px 30px; border-radius:30px; border:none; background:white; font-weight:bold;">PELAA UUDESTAAN</button>
</div>

<script>
    let score = 0;
    const history = document.getElementById('chat-history');
    const optionsCont = document.getElementById('options-container');

    // VIESTIPAKETIT
    const stages = {
        chatting: [
            { t: "Tykk√§√§n urheilla ja ulkoilla, ent√§ s√§? üèÉ‚Äç‚ôÇÔ∏è", type: 'good', pts: 40 },
            { t: "V√§h√§n kaikkea, mut kokkaaminen on mun juttu! üç≥", type: 'good', pts: 40 },
            { t: "Oot hyv√§n n√§k√∂inen ja sulla on isot tisit.", type: 'bad', f: "Jepu: EI! T√§m√§ on t√∂rke√§√§. Nainen haluaa tulla kohdelluksi ihmisen√§, ei esineen√§. Pisteet laskee!" },
            { t: "En mit√§√§n ihmeellist√§, tyls√§√§ on.", type: 'bad', f: "Jassu: √Ñl√§ ole tyls√§! Kukaan ei halua tytt√∂yst√§v√§ksi ihmist√§, jolla ei ole intohimoja." }
        ],
        dating: [
            { t: "Haluaisitko menn√§ ensi viikolla k√§velylle ja kahville? ‚òï", type: 'good', pts: 100 },
            { t: "Tied√§n yhden tosi kivan paikan, ment√§isk√∂ sinne sy√∂m√§√§n? üçï", type: 'good', pts: 100 },
            { t: "Tuu mun luo y√∂ksi, katsotaan leffaa.", type: 'bad', f: "Jepu: STOP! T√§m√§ on liian suoraa. Useimmat naiset kokevat t√§m√§n ahdistavaksi ensimm√§isen√§ ehdotuksena." },
            { t: "Menn√§√§nk√∂ sun luo?", type: 'bad', f: "Jassu: Todella huono idea. Ehdota aina jotain julkista paikkaa ensimm√§isille treffeille, se on turvallisempaa." }
        ]
    };

    function renderOptions() {
        optionsCont.innerHTML = "";
        let currentPool = score >= 80 ? stages.dating : stages.chatting;
        
        currentPool.forEach(opt => {
            const btn = document.createElement('div');
            btn.className = 'option';
            btn.innerText = opt.t;
            btn.onclick = () => select(opt);
            optionsCont.appendChild(btn);
        });
    }

    function select(opt) {
        addMsg(opt.t, 'me');
        if (opt.type === 'bad') {
            setTimeout(() => {
                const isJassu = Math.random() > 0.5;
                document.getElementById('coach-img').src = isJassu ? 'jassu.png' : 'jepu.png';
                document.getElementById('coach-txt').innerText = opt.f;
                document.getElementById('coach-feedback').style.display = 'flex';
                score = Math.max(0, score - 30);
                updateUI();
            }, 700);
        } else {
            score += opt.pts;
            updateUI();
            if (score >= 200) {
                setTimeout(() => document.getElementById('victory-screen').style.display = 'flex', 1000);
            } else {
                setTimeout(() => {
                    const ans = score >= 120 ? "Vitsi toi kuulostaa kivalta, menn√§√§n vaan! üòç" : "Kuulostaa kivalta! Kerro lis√§√§? üòä";
                    addMsg(ans, 'them');
                    renderOptions();
                }, 1000);
            }
        }
    }

    function addMsg(t, s) {
        const b = document.createElement('div');
        b.className = `msg ${s}`;
        b.innerText = t;
        history.appendChild(b);
        history.scrollTop = history.scrollHeight;
    }

    function updateUI() {
        document.getElementById('charm-val').innerText = score;
        document.getElementById('charm-fill').style.width = Math.min(100, (score/200)*100) + "%";
        if(score >= 80) document.getElementById('rank').innerText = "Charmantti";
        if(score >= 150) document.getElementById('rank').innerText = "Treffikuningas";
    }

    function closeFeedback() {
        document.getElementById('coach-feedback').style.display = 'none';
        renderOptions();
    }

    renderOptions();
</script>
</body>
</html>
