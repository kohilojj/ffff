<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Jassu & Jepu: Love Finder 2026</title>
    <script src="https://cdn.jsdelivr.net/npm/matter-js@0.19.0/build/matter.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; background: #ffc0cb; font-family: 'Comic Sans MS', cursive; }
        #ui { position: absolute; top: 20px; width: 100%; text-align: center; color: #d00060; pointer-events: none; z-index: 10; }
        #score { font-size: 40px; font-weight: bold; text-shadow: 2px 2px white; }
        #msg { 
            font-size: 50px; color: white; background: rgba(255,105,180,0.9); 
            padding: 20px; border-radius: 50px; display: none; 
            box-shadow: 0 0 20px rgba(255,255,255,0.8);
        }
        #instructions { position: absolute; bottom: 20px; width: 100%; text-align: center; color: #d00060; font-weight: bold; }
    </style>
</head>
<body>

<div id="ui">
    <div id="score">Matches: 0</div>
    <div id="msg">MUAH! ‚ù§Ô∏èüòò</div>
</div>
<div id="instructions">Ved√§ naamaa ja ammu se poikayst√§v√§n luo!</div>

<script>
    const { Engine, Render, Runner, Bodies, Composite, Mouse, MouseConstraint, Constraint, Events, Body } = Matter;

    const engine = Engine.create();
    const render = Render.create({
        element: document.body,
        engine: engine,
        options: { width: window.innerWidth, height: window.innerHeight, wireframes: false, background: 'transparent' }
    });

    // √Ñ√§niefekti
    const kissSound = new Audio('https://www.myinstants.com/media/sounds/kiss-sound-effect.mp3');

    function playKiss() {
        kissSound.currentTime = 0; // Aloita alusta jos useita osumia
        kissSound.play().catch(e => console.log("Klikkaa sivua ensin √§√§nien aktivoimiseksi!"));
    }

    const ground = Bodies.rectangle(window.innerWidth/2, window.innerHeight+25, window.innerWidth, 50, { isStatic: true });
    Composite.add(engine.world, ground);

    let score = 0;
    const slingshotPos = { x: 200, y: window.innerHeight - 200 };
    let currentBall = null;
    let sling = null;

    function spawnTarget() {
        const x = window.innerWidth - 150 - Math.random() * 300;
        const y = 100 + Math.random() * (window.innerHeight - 300);
        const target = Bodies.circle(x, y, 50, {
            isStatic: true,
            label: "target",
            render: { 
                sprite: { texture: 'ukko.png', xScale: 0.2, yScale: 0.2 } 
            }
        });
        Composite.add(engine.world, target);
    }

    function createSlingBall() {
        const isJassu = Math.random() > 0.5;
        currentBall = Bodies.circle(slingshotPos.x, slingshotPos.y, 45, {
            render: { 
                sprite: { texture: isJassu ? 'jassu.png' : 'jepu.png', xScale: 0.25, yScale: 0.25 } 
            }
        });
        
        sling = Constraint.create({
            pointA: slingshotPos,
            bodyB: currentBall,
            stiffness: 0.05,
            length: 0,
            render: { strokeStyle: '#d00060', lineWidth: 6 }
        });
        
        Composite.add(engine.world, [currentBall, sling]);
    }

    const mouse = Mouse.create(render.canvas);
    const mConstraint = MouseConstraint.create(engine, { mouse: mouse, constraint: { stiffness: 0.1, render: { visible: false } } });
    Composite.add(engine.world, mConstraint);

    Events.on(mConstraint, 'mouseup', () => {
        if (currentBall && currentBall.position.x > slingshotPos.x + 20) {
            setTimeout(() => {
                Composite.remove(engine.world, sling);
                sling = null;
            }, 50);
            
            setTimeout(() => {
                createSlingBall();
            }, 2500);
        }
    });

    Events.on(engine, 'collisionStart', (event) => {
        event.pairs.forEach(pair => {
            const labels = [pair.bodyA.label, pair.bodyB.label];
            if (labels.includes("target")) {
                const target = pair.bodyA.label === "target" ? pair.bodyA : pair.bodyB;
                
                // Poista kohde ja lis√§√§ pisteet
                Composite.remove(engine.world, target);
                score++;
                document.getElementById('score').innerText = "Matches: " + score;
                
                // PUSU-EFEKTI
                playKiss();
                const msg = document.getElementById('msg');
                msg.style.display = 'inline-block';
                setTimeout(() => msg.style.display = 'none', 1200);
                
                spawnTarget(); 
            }
        });
    });

    Render.run(render);
    Runner.run(Runner.create(), engine);

    createSlingBall();
    for(let i=0; i<3; i++) spawnTarget();

</script>
</body>
</html>
